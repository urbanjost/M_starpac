!ERFC
      real function erfc (x)
! JULY 1977 EDITION.  W. FULLERTON, C3, LOS ALAMOS SCIENTIFIC LAB.
!
!  VARIABLE DECLARATIONS
!
!  SCALAR ARGUMENTS
      real x
!
!  LOCAL SCALARS
      real eta,sqeps,sqrtpi,xmax,xsml,y
      integer nterc2,nterf,nterfc
!
!  LOCAL ARRAYS
      real erc2cs(23),erfccs(24),erfcs(13)
!
!  EXTERNAL FUNCTIONS
!      REAL CSEVL,R1MACH
!      INTEGER INITS
!       EXTERNAL CSEVL,R1MACH,INITS
!
!  EXTERNAL SUBROUTINES
!       EXTERNAL XERROR
!
!  INTRINSIC FUNCTIONS
      intrinsic abs,exp,log,sqrt
!
!
! SERIES FOR ERF        ON THE INTERVAL  0.          TO  1.00000D+00
!                                        WITH WEIGHTED ERROR   7.10E-18
!                                         LOG WEIGHTED ERROR  17.15
!                               SIGNIFICANT FIGURES REQUIRED  16.31
!                                    DECIMAL PLACES REQUIRED  17.71
!
      data erfcs( 1) /   -.049046121234691808e0 /
      data erfcs( 2) /   -.14226120510371364e0 /
      data erfcs( 3) /    .010035582187599796e0 /
      data erfcs( 4) /   -.000576876469976748e0 /
      data erfcs( 5) /    .000027419931252196e0 /
      data erfcs( 6) /   -.000001104317550734e0 /
      data erfcs( 7) /    .000000038488755420e0 /
      data erfcs( 8) /   -.000000001180858253e0 /
      data erfcs( 9) /    .000000000032334215e0 /
      data erfcs(10) /   -.000000000000799101e0 /
      data erfcs(11) /    .000000000000017990e0 /
      data erfcs(12) /   -.000000000000000371e0 /
      data erfcs(13) /    .000000000000000007e0 /
!
! SERIES FOR ERFC       ON THE INTERVAL  0.          TO  2.50000D-01
!                                        WITH WEIGHTED ERROR   4.81E-17
!                                         LOG WEIGHTED ERROR  16.32
!                        APPROX SIGNIFICANT FIGURES REQUIRED  15.0
! SERIES FOR ERC2       ON THE INTERVAL  2.50000D-01 TO  1.00000D+00
!                                        WITH WEIGHTED ERROR   5.22E-17
!                                         LOG WEIGHTED ERROR  16.28
!                        APPROX SIGNIFICANT FIGURES REQUIRED  15.0
!                                    DECIMAL PLACES REQUIRED  16.96
!
      data erc2cs( 1) /   -.069601346602309501e0 /
      data erc2cs( 2) /   -.041101339362620893e0 /
      data erc2cs( 3) /    .003914495866689626e0 /
      data erc2cs( 4) /   -.000490639565054897e0 /
      data erc2cs( 5) /    .000071574790013770e0 /
      data erc2cs( 6) /   -.000011530716341312e0 /
      data erc2cs( 7) /    .000001994670590201e0 /
      data erc2cs( 8) /   -.000000364266647159e0 /
      data erc2cs( 9) /    .000000069443726100e0 /
      data erc2cs(10) /   -.000000013712209021e0 /
      data erc2cs(11) /    .000000002788389661e0 /
      data erc2cs(12) /   -.000000000581416472e0 /
      data erc2cs(13) /    .000000000123892049e0 /
      data erc2cs(14) /   -.000000000026906391e0 /
      data erc2cs(15) /    .000000000005942614e0 /
      data erc2cs(16) /   -.000000000001332386e0 /
      data erc2cs(17) /    .000000000000302804e0 /
      data erc2cs(18) /   -.000000000000069666e0 /
      data erc2cs(19) /    .000000000000016208e0 /
      data erc2cs(20) /   -.000000000000003809e0 /
      data erc2cs(21) /    .000000000000000904e0 /
      data erc2cs(22) /   -.000000000000000216e0 /
      data erc2cs(23) /    .000000000000000052e0 /
!
!                                    DECIMAL PLACES REQUIRED  17.01
!
      data erfccs( 1) /   0.0715179310202925e0 /
      data erfccs( 2) /   -.026532434337606719e0 /
      data erfccs( 3) /    .001711153977920853e0 /
      data erfccs( 4) /   -.000163751663458512e0 /
      data erfccs( 5) /    .000019871293500549e0 /
      data erfccs( 6) /   -.000002843712412769e0 /
      data erfccs( 7) /    .000000460616130901e0 /
      data erfccs( 8) /   -.000000082277530261e0 /
      data erfccs( 9) /    .000000015921418724e0 /
      data erfccs(10) /   -.000000003295071356e0 /
      data erfccs(11) /    .000000000722343973e0 /
      data erfccs(12) /   -.000000000166485584e0 /
      data erfccs(13) /    .000000000040103931e0 /
      data erfccs(14) /   -.000000000010048164e0 /
      data erfccs(15) /    .000000000002608272e0 /
      data erfccs(16) /   -.000000000000699105e0 /
      data erfccs(17) /    .000000000000192946e0 /
      data erfccs(18) /   -.000000000000054704e0 /
      data erfccs(19) /    .000000000000015901e0 /
      data erfccs(20) /   -.000000000000004729e0 /
      data erfccs(21) /    .000000000000001432e0 /
      data erfccs(22) /   -.000000000000000439e0 /
      data erfccs(23) /    .000000000000000138e0 /
      data erfccs(24) /   -.000000000000000048e0 /
!
      data sqrtpi /1.7724538509055160e0/
      data nterf, nterfc, nterc2, xsml, xmax, sqeps /3*0, 3*0./
!
      if (nterf.ne.0) go to 10
      eta = 0.1*r1mach(3)
      nterf = inits (erfcs, 13, eta)
      nterfc = inits (erfccs, 24, eta)
      nterc2 = inits (erc2cs, 23, eta)
!
      xsml = -sqrt (-log(sqrtpi*r1mach(3)))
      xmax = sqrt (-log(sqrtpi*r1mach(1)))
      xmax = xmax - 0.5*log(xmax)/xmax - 0.01
      sqeps = sqrt (2.0*r1mach(3))
!
 10   if (x.gt.xsml) go to 20
!
! ERFC(X) = 1.0 - ERF(X) FOR X .LT. XSML
!
      erfc = 2.0
      return
!
 20   if (x.gt.xmax) go to 40
      y = abs(x)
      if (y.gt.1.0) go to 30
!
! ERFC(X) = 1.0 - ERF(X) FOR -1. .LE. X .LE. 1.
!
      if (y.lt.sqeps) then
         erfc = 1.0 - 2.0*x/sqrtpi
      else
         erfc = 1.0 - x*(1.0 + csevl (2.*x*x-1., erfcs, nterf) )
      end if
!
      return
!
! ERFC(X) = 1.0 - ERF(X) FOR 1. .LT. ABS(X) .LE. XMAX
!
 30   y = y*y
      if (y.le.4.) then
        erfc = exp(-y)/abs(x) *&
     &         (0.5 + csevl ((8.0/y-5.0)/3.0, erc2cs, nterc2) )
      else
        erfc = exp(-y)/abs(x) *&
     &          (0.5 + csevl (8.0/y-1.0, erfccs, nterfc) )
      end if
      if (x.lt.0.0) erfc = 2.0 - erfc
      return
!
 40   call xerror ('ERFC    X SO BIG ERFC UNDERFLOWS', 32, 1, 1)
      erfc = 0.0
      return
!
      end
