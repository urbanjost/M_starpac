!CDFCHI
      FUNCTION CDFCHI(CHISQR, DF)
      REAL(KIND=WP) :: CDFCHI
!
!     LATEST REVISION  -  03/15/90  (JRD)
!
!     THIS ROUTINE COMPUTES THE CHI SQUARE CUMULATIVE DISTRIBUTION
!     FUNCTION FROM THE INCOMPLETE GAMMA FUNCTION RATIO AS DISCUSSED IN
!     CHAPTER 17 OF DISTRIBUTIONS IN STATISTICS - CONTINUOUS UNIVARIATE
!     DISTRIBUTIONS - 1, BY JOHNSON AND KOTZ.
!
!     WRITTEN BY - JANET R. DONALDSON
!                  STATISTICAL ENGINEERING DIVISION
!                  NATIONAL BUREAU OF STANDARDS, BOULDER, COLORADO
!
!     CREATION DATE - DECEMBER 7, 1981
!
!
!  VARIABLE DECLARATIONS
!
!  SCALAR ARGUMENTS
      REAL(KIND=WP) ::
     &   CHISQR,DF
!
!  LOCAL SCALARS
      REAL(KIND=WP) ::
     &   FPLPM
!
!  EXTERNAL FUNCTIONS
      REAL(KIND=WP) ::
     &   DGAMI,DGAMMA,D1MACH
      LOGICAL
     &   MVCHK
!       EXTERNAL DGAMI,DGAMMA,D1MACH,MVCHK
!
!     VARIABLE DEFINITIONS (ALPHABETICALLY)
!
!     REAL(KIND=WP) :: CHISQR
!        THE PERCENT POINT FROM THE CHI SQUARED DISTRIBUTION.
!     REAL(KIND=WP) :: DF
!        THE DEGREES OF FREEDOM.
!     REAL(KIND=WP) :: FPLPM
!        THE DOUBLE PRECISION FLOATING POINT LARGEST POSITIVE MAGNITUDE.
!
!     COMMENCE BODY OF ROUTINE
!
      FPLPM = D1MACH(2)
!
      CDFCHI = DGAMI(0.5_WP*DF, 0.5_WP*CHISQR)
      IF (MVCHK(CDFCHI,FPLPM)) THEN
         CDFCHI = 1.0_WP
      ELSE
         CDFCHI = CDFCHI / DGAMMA(0.5_WP*DF)
         IF (CDFCHI.LT.0.0_WP) CDFCHI = 0.0_WP
         IF (CDFCHI.GT.1.0_WP) CDFCHI = 1.0_WP
      END IF
!
      RETURN
      END
