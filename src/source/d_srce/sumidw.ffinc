!SUMIDW
      SUBROUTINE SUMIDW(X, W, N, XMEANW, SUMDI)
!
!     LATEST REVISION  -  03/15/90  (JRD)
!
!     A ROUTINE TO CALCULATE THE SUM OF THE PRODUCTS OF I AND THE I TH
!     DIFFERENCE AMONG THE ELEMENTS OF THE VECTOR X - XMEANW WHICH
!     ARE NOT WEIGHTED ZERO.  (ELEMENTS WEIGHTED ZERO DO NOT
!     PRODUCE AN INCREMENT IN I.)
!
!     WRITTEN BY - JOHN E. KOONTZ
!                  STATISTICAL ENGINEERING DIVISION
!                  NATIONAL BUREAU OF STANDARDS, BOULDER, COLORADO
!
!     CREATION DATE  -  MAY 17, 1982
!
!
!  VARIABLE DECLARATIONS
!
!  SCALAR ARGUMENTS
      REAL(KIND=WP) ::
     +   SUMDI,XMEANW
      INTEGER
     +   N
!
!  ARRAY ARGUMENTS
      REAL(KIND=WP) ::
     +   W(N),X(N)
!
!  LOCAL SCALARS
      REAL(KIND=WP) ::
     +   DIFF,I
      INTEGER
     +   K
!
!     VARIABLE DEFINITIONS (ALPHABETICALLY)
!
!     REAL(KIND=WP) :: DIFF
!        THE DIFFERENCE OF A VALUE OF X AND THE WEIGHTED MEAN OF X.
!     REAL(KIND=WP) :: I
!        I COUNTS FROM 1 TO THE NUMBER OF NON-ZERO WEIGHTED ELEMENTS
!        FOUND IN X.
!     INTEGER K
!        A LOOP INDEX.
!     INTEGER N
!        INPUT PARAMETER.  THE NUMBER OF ELEMENTS IN X.
!     REAL(KIND=WP) :: SUMDI
!        OUTPUT PARAMETER.  THE SUM OF THE PRODUCTS OF I AND THE
!        NON-ZERO WEIGHTED ELEMENTS OF THE VECTOR X - XMEANW.
!     REAL(KIND=WP) :: W(N)
!        INPUT PARAMETER.  THE WEIGHTS VECTOR FOR X.
!     REAL(KIND=WP) :: X(N)
!        INPUT PARAMETER.  THE VECTOR OF N DATA VALUES.
!     REAL(KIND=WP) :: XMEANW
!        INPUT PARAMETER.  THE WEIGHTED MEAN OF X.
!
      I = 0.0E0_WP
      SUMDI = 0.0E0_WP
      DO 10 K=1,N
         IF (W(K).EQ.0.0E0_WP) GO TO 10
         DIFF = X(K) - XMEANW
         I = I + 1.0E0_WP
         SUMDI = SUMDI + I*DIFF
   10 CONTINUE
      RETURN
      END
